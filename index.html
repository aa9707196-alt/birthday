<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Birthday Web üíå</title>
  <link href="https://fonts.googleapis.com/css2?family=Lobster+Two:wght@700&family=Pacifico&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#FFF5F7; --card:#FFFBFC; --ring:#FFD6E0;
      --ink:#5C3A3A; --muted:#B08A8A; --brown:#A0665A; --caramel:#D4876E;
      --heart:#ff6b9d; --pink:#ffb3d9; --gold:#FFD700;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    
    html {
      scroll-behavior: smooth;
      overflow: hidden;
    }
    
    body{
      background:linear-gradient(135deg, #FFF5F7 0%, #FFE4EC 50%, #FFD6E0 100%);
      color:var(--ink);font-family:"Quicksand",system-ui,-apple-system,Segoe UI,Roboto,Arial;
      position:relative;
      height: 100vh;
      overflow-y: auto; 
      overflow-x: hidden;
    }

    .view {
      min-height: 100vh;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      position: relative;
    }

    .view:not(#home) {
        display: none;
    }
    
    @keyframes reveal {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .revealed {
        animation: reveal 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    }
    
    #home{
      text-align: center;
      color:#fff;text-shadow:0 4px 12px rgba(0,0,0,.5), 0 2px 4px rgba(255,107,157,.4);
      background:linear-gradient(rgba(160,102,90,.4),rgba(255,182,193,.3)),url('images/andikaa.jpg') center/cover no-repeat;
    }

    #transitionWrap{
      background:linear-gradient(135deg, rgba(255,245,247,.95) 0%, rgba(255,228,236,.95) 100%),
                 url('images/backgroundlove.jpg') center/cover no-repeat;
      overflow: hidden;
    }
    
    .floating-images{position:absolute;inset:0;pointer-events:none;z-index:1}
    .float-img{position:absolute;width:120px;height:120px;border-radius:20px;box-shadow:0 10px 30px rgba(255,107,157,.25);animation:floatAround 20s ease-in-out infinite;object-fit:cover;border:4px solid rgba(255,255,255,.8);transform-origin:center}
    .float-img:nth-child(1){top:10%;left:5%;animation-delay:0s;animation-duration:18s}
    .float-img:nth-child(2){top:15%;right:8%;animation-delay:2s;animation-duration:22s;width:100px;height:100px}
    .float-img:nth-child(3){bottom:15%;left:10%;animation-delay:4s;animation-duration:20s;width:110px;height:110px}
    .float-img:nth-child(4){top:50%;right:5%;animation-delay:1s;animation-duration:19s}
    .float-img:nth-child(5){bottom:10%;right:15%;animation-delay:3s;animation-duration:21s;width:105px;height:105px}
    @keyframes floatAround{
      0%,100%{transform:translateY(0) rotate(0deg) scale(1)}
      25%{transform:translateY(-30px) rotate(5deg) scale(1.05)}
      50%{transform:translateY(-20px) rotate(-5deg) scale(.95)}
      75%{transform:translateY(-40px) rotate(3deg) scale(1.02)}
    }
    @media(max-width:768px){
      .float-img{width:80px!important;height:80px!important}
      .float-img:nth-child(2),.float-img:nth-child(4){display:none}
    }
    
    .hearts-container{position:fixed;inset:0;pointer-events:none;overflow:hidden;z-index:99}
    .heart{position:absolute;font-size:24px;animation:floatUp 7s ease-in infinite;opacity:0;filter:drop-shadow(0 2px 4px rgba(255,107,157,.3))}
    @keyframes floatUp{0%{transform:translateY(100vh) rotate(0) scale(0);opacity:0}10%{opacity:.9;transform:translateY(90vh) rotate(45deg) scale(1)}90%{opacity:.7}100%{transform:translateY(-100px) rotate(360deg) scale(.8);opacity:0}}
    .sparkle-trail{position:fixed;pointer-events:none;z-index:100}
    .trail-item{position:absolute;font-size:14px;animation:trailFade 1s ease-out forwards}
    @keyframes trailFade{0%{opacity:1;transform:scale(1) rotate(0)}100%{opacity:0;transform:scale(.3) rotate(180deg)}}
    .sparkle{position:absolute;width:6px;height:6px;background:var(--gold);border-radius:50%;pointer-events:none;box-shadow:0 0 8px var(--gold);animation:sparkleAnim 1.2s ease-out forwards}
    @keyframes sparkleAnim{0%{transform:scale(0) translate(0,0);opacity:1}100%{transform:scale(1.5) translate(var(--tx),var(--ty));opacity:0}}

    #home h1{font-family:"Pacifico",cursive;font-size:clamp(36px,8vw,64px);margin-bottom:.6rem;animation:bounceIn 1.2s cubic-bezier(.68,-.55,.265,1.55);background:linear-gradient(135deg, #fff 0%, #FFE4EC 50%, #FFC0CB 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;filter:drop-shadow(0 2px 8px rgba(255,255,255,.4))}
    #home p{color:rgba(255,255,255,.95);margin-bottom:1.4rem;animation:fadeIn 1s ease-in .3s both;font-size:18px;font-weight:600;letter-spacing:.5px;}
    .buttons{display:flex;gap:16px;flex-wrap:wrap;justify-content:center;animation:fadeIn 1.4s ease-in .6s both;}
    .btn{
      border:0;border-radius:50px;padding:16px 28px;min-width:180px;
      font-weight:700;font-size:17px;cursor:pointer;background:linear-gradient(135deg, var(--caramel), var(--heart));
      color:#fff;box-shadow:0 8px 20px rgba(255,107,157,.35), 0 0 0 0 rgba(255,107,157,.4);
      transition:all .3s ease;position:relative;overflow:hidden;
      animation:pulse 2s ease-in-out infinite
    }
    @keyframes pulse{0%,100%{box-shadow:0 8px 20px rgba(255,107,157,.35), 0 0 0 0 rgba(255,107,157,.4)}50%{box-shadow:0 10px 25px rgba(255,107,157,.45), 0 0 0 10px rgba(255,107,157,0)}}
    .btn::before{content:'';position:absolute;inset:0;background:linear-gradient(45deg,transparent,rgba(255,255,255,.3),transparent);transform:translateX(-100%);transition:transform .6s}
    .btn:hover::before{transform:translateX(100%)}
    .btn:hover{transform:translateY(-4px) scale(1.08);box-shadow:0 12px 30px rgba(255,107,157,.5)}
    .btn:active{transform:translateY(-2px) scale(1.02)}
    .btn.alt{background:linear-gradient(135deg, #fff, #FFE4EC);color:var(--heart);box-shadow:0 8px 20px rgba(255,182,193,.3)}
    #noBtn{transition:all .2s cubic-bezier(.68,-.55,.265,1.55)}
    
    .card{width:min(850px,96%);background:rgba(255,251,252,.95);backdrop-filter:blur(10px);border-radius:30px;padding:40px 30px;text-align:center;border:3px solid rgba(255,214,224,.6);box-shadow:0 20px 60px rgba(255,107,157,.2);position:relative; z-index: 2; max-height: 95vh;}
    .title{font-family:"Pacifico",cursive;background:linear-gradient(135deg, var(--brown), var(--heart));-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:clamp(30px,6vw,44px);margin-bottom:12px;}
    .sub{color:var(--muted);margin-bottom:20px;font-size:15px;font-weight:600}
    .timeline{display:grid;gap:18px;margin-top:12px;}
    @media(min-width:680px){.timeline{grid-template-columns:repeat(2,1fr)}}
    
    .cardItem{background:linear-gradient(135deg, #fff 0%, #FFF8FA 100%);border-radius:20px;padding:16px 18px;box-shadow:0 6px 20px rgba(255,107,157,.12);border:2px solid rgba(255,214,224,.5);display:flex;align-items:center;gap:14px;transition:all .4s cubic-bezier(.68,-.55,.265,1.55);cursor:pointer;position:relative;overflow:hidden;}
    .cardItem::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,182,193,.15),rgba(255,192,203,.1));opacity:0;transition:opacity .3s}
    .cardItem:hover::before{opacity:1}
    .cardItem:hover{transform:translateY(-6px) scale(1.03) rotate(-1deg);box-shadow:0 15px 35px rgba(255,107,157,.25);border-color:var(--pink)}
    .thumb{width:64px;height:64px;border-radius:16px;overflow:hidden;flex:0 0 64px;display:grid;place-items:center;background:#fff;box-shadow:0 4px 12px rgba(255,107,157,.15);}
    .thumb img{width:100%;height:100%;object-fit:cover;}
    .meta{text-align:left;}
    .time{font-weight:700;color:var(--heart);margin-bottom:4px;font-size:15px}
    .desc{font-weight:600;color:#594437;font-size:14px}
    .ctaRow{margin-top:22px;display:flex;justify-content:center;}
    
    .dressgrid{margin:26px 0;display:inline-grid;grid-template-columns:1fr 1fr;gap:20px;}
    @media(max-width:640px){.dressgrid{grid-template-columns:1fr;gap:16px}}
    .fit{width:100%;max-width:220px;border-radius:20px;display:block;box-shadow:0 10px 30px rgba(255,107,157,.2);border:4px solid rgba(255,255,255,.8);cursor:pointer;transition:all .5s cubic-bezier(.68,-.55,.265,1.55);position:relative;overflow:hidden;}
    .fit::before{content:'üíï';position:absolute;top:10px;right:10px;font-size:28px;opacity:0;transition:all .3s;z-index:2}
    .fit:hover::before{opacity:1;transform:scale(1.2) rotate(15deg)}
    .fit:hover{transform:scale(1.08) rotate(-3deg);box-shadow:0 18px 45px rgba(255,107,157,.35);border-color:var(--pink)}
    
    .envelope-area{display:grid;justify-items:center;gap:18px;margin-top:12px;}
    .envelope{width:300px;height:200px;position:relative;perspective:1000px;cursor:pointer;filter:drop-shadow(0 10px 25px rgba(255,107,157,.25));transition:transform .4s ease;}
    .envelope:hover{transform:scale(1.1) rotate(2deg)}
    .env-body{position:absolute;inset:0;background:linear-gradient(135deg, #f0d5c7, #e7cdb5);border-radius:16px;}
    .env-flap{position:absolute;left:0;right:0;top:0;height:50%;background:linear-gradient(135deg, #d9b89a, #caa786);border-top-left-radius:16px;border-top-right-radius:16px;transform-origin:top;transition:transform .7s cubic-bezier(.68,-.55,.265,1.55);}
    .env-bottom{position:absolute;left:0;right:0;bottom:0;height:60%;background:linear-gradient(135deg, #e7cdb5, #e1c3a7);border-bottom-left-radius:16px;border-bottom-right-radius:16px}
    .letter{position:absolute;left:12px;right:12px;top:32px;height:130px;background:#fff;border-radius:14px;box-shadow:0 10px 25px rgba(0,0,0,.15);transition:transform .7s cubic-bezier(.68,-.55,.265,1.55);padding:16px;display:flex;align-items:center;justify-content:center}
    .sweet p{color:#5a3a24;font-size:14px;font-weight:600}

    .letter-modal{position:fixed;inset:0;background:rgba(255,107,157,.15);backdrop-filter:blur(12px);display:flex;align-items:center;justify-content:center;padding:24px;opacity:0;visibility:hidden;pointer-events:none;transition:all .5s ease;z-index:200}
    .letter-modal.show{opacity:1;visibility:visible;pointer-events:auto}
    .letter-content{width:min(680px,96%);max-height:85vh;background:linear-gradient(135deg, #fff 0%, #FFF8FA 100%);border-radius:30px;padding:50px 35px;box-shadow:0 25px 70px rgba(255,107,157,.3);overflow-y:auto;position:relative;transform:scale(.85) translateY(30px) rotate(-5deg);opacity:0;transition:all .5s cubic-bezier(.68,-.55,.265,1.55);}
    .letter-modal.show .letter-content{transform:scale(1) translateY(0) rotate(0deg);opacity:1}
    .letter-content h2{font-family:"Pacifico",cursive;background:linear-gradient(135deg, var(--brown), var(--heart));-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:clamp(32px,5vw,42px);margin-bottom:24px;text-align:center}
    .letter-content p{color:#5a3a24;line-height:1.8;margin:18px 0;font-size:17px;text-align:left}
    .letter-content .tiny{font-size:15px;color:#8F6E4A;margin-top:14px;font-style:italic}
    .close-letter{position:absolute;top:18px;right:18px;width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg, var(--caramel), var(--heart));color:#fff;border:0;cursor:pointer;font-size:24px;display:grid;place-items:center;}
    
    .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:24px;background:rgba(255,107,157,.2);opacity:0;visibility:hidden;pointer-events:none;transition:opacity .3s ease;z-index:100;backdrop-filter:blur(8px)}
    .overlay.show{opacity:1;visibility:visible;pointer-events:auto}
    .popup{width:min(540px,96%);background:linear-gradient(135deg, #fff, #FFF8FA);border-radius:25px;padding:28px;text-align:center;box-shadow:0 20px 50px rgba(255,107,157,.35);transform:scale(.9) rotate(-5deg);opacity:0;transition:all .3s cubic-bezier(.68,-.55,.265,1.55);animation:shake .6s ease-in-out;}
    .overlay.show .popup{transform:scale(1) rotate(0deg);opacity:1}
    .imgbox{width:150px;height:150px;margin:8px auto 16px;border-radius:20px;overflow:hidden;border:3px solid rgba(255,214,224,.6);box-shadow:0 8px 20px rgba(255,107,157,.2)}
    .imgbox img{width:100%;height:100%;object-fit:cover}
    
    /* === CSS UNTUK EFEK CONFETTI JATUH === */
    .confetti-piece{position:absolute;width:12px;height:12px;top:calc(-20px);animation:confettiFall 4s linear forwards; position: fixed; z-index: 150;}
    @keyframes confettiFall{to{transform:translateY(100vh) rotate(1080deg);opacity:0}}
    
    .big-love{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);font-size:250px;opacity:0;pointer-events:none;z-index:300;filter:drop-shadow(0 0 30px rgba(255,107,157,.6));animation:lovePulse 2.5s ease-out forwards}
    @keyframes lovePulse{0%{transform:translate(-50%,-50%) scale(0) rotate(0deg);opacity:0}40%{transform:translate(-50%,-50%) scale(1.4) rotate(180deg);opacity:1}70%{transform:translate(-50%,-50%) scale(1.2) rotate(270deg);opacity:1}100%{transform:translate(-50%,-50%) scale(0) rotate(360deg);opacity:0}}
    
    @keyframes bounceIn{0%{transform:scale(0) rotate(-180deg);opacity:0}60%{transform:scale(1.2) rotate(10deg);opacity:1}100%{transform:scale(1) rotate(0deg)}}
    @keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
    @keyframes shake{0%,100%{transform:translateX(0) rotate(0deg)}25%{transform:translateX(-12px) rotate(-8deg)}75%{transform:translateX(12px) rotate(8deg)}}
    @keyframes wiggle{0%,100%{transform:rotate(0deg) scale(1)}25%{transform:rotate(-8deg) scale(1.05)}75%{transform:rotate(8deg) scale(1.05)}}

  </style>
</head>
<body>

  <div class="hearts-container" id="heartsContainer"></div>
  <div class="sparkle-trail" id="sparkleTrail"></div>

  <!-- VIEW 1: HOME -->
  <section id="home" class="view">
    <div>
      <h1>Hey, it's your birthday! ü•≥</h1>
      <p>Would you like to celebrate with me?</p>
      <div class="buttons">
        <button class="btn" id="yesBtn">Yes, of course! üíï</button>
        <button class="btn alt" id="noBtn">Nggak mau üôÖ‚Äç‚ôÇ</button>
      </div>
    </div>
  </section>

  <!-- VIEW 2: TRANSITION -->
  <section id="transitionWrap" class="view">
    <div class="floating-images">
      <img class="float-img" src="images/loveballoon.jpg" alt="love balloon">
      <img class="float-img" src="images/pinkbutterfly.jpg" alt="pink butterfly">
      <img class="float-img" src="images/teddyholdcake.jpg" alt="teddy hold cake">
      <img class="float-img" src="images/teddypink.jpg" alt="teddy pink">
      <img class="float-img" src="images/teddybearholdcake.jpg" alt="teddy bear hold cake">
    </div>
    <div class="card">
      <div class="title">You really said yes, huh? üòö</div>
      <p style="margin-top:14px; line-height:1.85; font-size:17px;">
        I don't know why, but that tiny "yes" means a lot to me.<br/>
        I've been quietly planning this, trying to make sure everything feels warm, soft,
        and full of little things that remind me of you. ü•π<br/><br/>
        You work so hard every single day, barely have time for yourself,
        yet you still choose to spend your day with me ‚Äî that's something I'll never take for granted. üíï<br/><br/>
        Now‚Ä¶ are you ready to see what I've prepared for us? ‚ú®
      </p>
      <div class="ctaRow" style="margin-top:24px;">
        <button class="btn next" id="toRundown">Show me! üíå</button>
      </div>
    </div>
  </section>

  <!-- VIEW 3: RUNDOWN -->
  <section id="rundownWrap" class="view">
    <div class="card">
      <div class="title">Rundown in ur day ‚ú®</div>
      <div class="sub">Let's make it cozy & sweet (tap for details!)</div>
      <div class="timeline">
        <div class="cardItem" data-activity="pickup"><div class="thumb"><img src="images/motor.jpg" alt="motor"></div><div class="meta"><div class="time">10.00</div><div class="desc">Pick up ur gf üíï</div></div></div>
        <div class="cardItem" data-activity="sushi"><div class="thumb"><img src="images/sushi.jpg" alt="sushi"></div><div class="meta"><div class="time">12.00</div><div class="desc">Lunch sushi @ Tom Sushi Royal Plaza üç£</div></div></div>
        <div class="cardItem" data-activity="photobox"><div class="thumb"><img src="images/photobox.jpg" alt="photobox"></div><div class="meta"><div class="time">14.00</div><div class="desc">Photobox @ Gwiyomi Royal Plaza üì∏</div></div></div>
        <div class="cardItem" data-activity="coffee"><div class="thumb"><img src="images/coffee.jpg" alt="coffee"></div><div class="meta"><div class="time">15.00</div><div class="desc">Ngopi & yapping @ Coste Caf√© ‚òï</div></div></div>
        <div class="cardItem" style="grid-column:1/-1" data-activity="gift"><div class="thumb"><img src="images/gift.jpg" alt="gift"></div><div class="meta"><div class="time">16.00 ‚Äî end</div><div class="desc">Gift reveal & our time üéÅ‚ú®</div></div></div>
      </div>
      <div class="ctaRow"><button class="btn next" id="toDress">Next ‚Üí Dresscode</button></div>
    </div>
  </section>

  <!-- VIEW 4: DRESSCODE -->
  <section id="dressWrap" class="view">
    <div class="card">
      <div class="title">Dresscode for ur day ü§é</div>
      <div class="sub">Please wear ur best outfit, let's make our day the happiest.<br/> I love u sayangggg! üíï</div>
      <div class="dressgrid">
        <img class="fit" src="images/bajucowok.jpg" alt="baju cowok">
        <img class="fit" src="images/bajucewek.jpg" alt="baju cewek">
      </div>
      <div class="sub" style="font-style:italic;color:#A0665A">"Don't worry about the outfit ‚Äî I've prepared it for you. Just bring black bottom pants and make sure you look good! üòò"</div>
      <div class="ctaRow"><button class="btn next" id="toSurprise">Next ‚Üí Surprise</button></div>
    </div>
  </section>

  <!-- VIEW 5: SURPRISE / ENVELOPE -->
  <section id="surpriseWrap" class="view">
    <div class="card">
      <div class="title">Open this little letter for u üíå</div>
      <div class="sub">tap the envelope ‚Üì</div>
      <div class="envelope-area">
        <div class="envelope" id="envelope">
          <div class="env-body"></div>
          <div class="env-flap"></div>
          <div class="env-bottom"></div>
          <div class="letter"><div class="sweet"><p>Click to read full letter... üíï</p></div></div>
        </div>
        <div class="ctaRow"><button class="btn" id="backDress">‚Üê Back to Dresscode</button></div>
      </div>
    </div>
  </section>

  <!-- MODAL & POPUP -->
  <div class="letter-modal" id="letterModal">
    <div class="letter-content">
      <button class="close-letter" id="closeLetter">√ó</button>
      <h2>To My Birthday Boy üíå</h2>
      <p>Hi birthday boy,</p>
      <p>You don't need to prepare anything, okay? No pressure at all. Just come as you are ‚Äî comfy, happy, and with that cute smile of yours ü•π</p>
      <p>I'll take care of everything: places, bills, tiny surprises‚Ä¶ I just want you to feel loved, celebrated, and super at ease today.</p>
      <p>Thank you for being you. Let me spoil you a little ‚Äî it's your day ü§é</p>
      <p class="tiny">ps: if you forget anything, it's okay. I only need you here with me. Always. üíï</p>
    </div>
  </div>

  <section class="overlay" id="noBtnOverlay" aria-hidden="true">
    <div class="popup">
      <div class="imgbox"><img src="images/harusmau.jpg" alt="cute angry"></div>
      <h3>Harus mau! üò§üíï</h3>
      <p>Please say yes‚Ä¶ it's your special day!</p>
      <div class="buttons"><button class="btn" id="closePopup">Okayyy fine! ü•∫</button></div>
    </div>
  </section>
  
  <section class="overlay" id="rundownOverlay" aria-hidden="true">
    <div class="popup">
      <div class="imgbox"><img id="popupImage" src="" alt="Activity Image"></div>
      <h3 id="popupTitle"></h3>
      <p id="popupText"></p>
      <div class="buttons" style="margin-top: 1rem;"><button class="btn" id="closeRundownPopup">Close</button></div>
    </div>
  </section>


  <script>
    document.addEventListener('DOMContentLoaded', () => {

        const views = {
            transition: document.getElementById('transitionWrap'),
            rundown: document.getElementById('rundownWrap'),
            dress: document.getElementById('dressWrap'),
            surprise: document.getElementById('surpriseWrap')
        };

        // === FUNGSI UTAMA YANG TELAH DIPERBAIKI SECARA TOTAL ===
        function showNextSection(targetElement) {
            if (!targetElement) return;

            // 1. Pastikan section target terlihat agar bisa di-scroll
            if (getComputedStyle(targetElement).display === 'none') {
                targetElement.style.display = 'flex';
                targetElement.classList.add('revealed');
            }
            
            // 2. Beri browser waktu sesaat (50ms) untuk menerapkan perubahan display
            setTimeout(() => {
                // 3. MULAI proses scroll ke section target
                targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });

                // 4. INI BAGIAN KUNCI: Tunggu animasi scroll selesai (sekitar 600ms)
                setTimeout(() => {
                    // 5. SETELAH scroll selesai, BARU picu hujan confetti.
                    //    Ini memastikan confetti muncul di section yang DITUJU.
                    createConfetti();
                }, 600); // Jeda 600 milidetik untuk menunggu scroll
            }, 50);
        }

        // --- Semua event listener sekarang menggunakan fungsi baru yang sudah benar ---

        document.getElementById('yesBtn').addEventListener('click', (e) => {
            createSparkles(e);
            // Tambahkan jeda awal untuk efek dramatis
            setTimeout(() => {
                showNextSection(views.transition);
            }, 400);
        });

        document.getElementById('toRundown').addEventListener('click', (e) => {
            createSparkles(e);
            showNextSection(views.rundown);
        });
        document.getElementById('toDress').addEventListener('click', (e) => {
            createSparkles(e);
            showNextSection(views.dress);
        });
        document.getElementById('toSurprise').addEventListener('click', (e) => {
            createSparkles(e);
            showNextSection(views.surprise);
        });
        
        document.getElementById('backDress').addEventListener('click', (e) => {
            createSparkles(e);
            document.getElementById('dressWrap').scrollIntoView({ behavior: 'smooth', block: 'start' });
        });

        setupPopupsAndEffects();
    });

    let createSparkles = (e) => {}; 
    let createConfetti = () => {};

    function setupPopupsAndEffects() {
        const noBtnOverlay = document.getElementById('noBtnOverlay');
        const rundownOverlay = document.getElementById('rundownOverlay');
        const letterModal = document.getElementById('letterModal');
        
        const rundownData = {
            pickup: { image: "images/motor.jpg", title: "Pick-up ur gf üíï", text: "‚ÄúDon't worry, I'll wait in front ‚Äî no rush, just come as you are ü§é‚Äù" },
            sushi: { image: "images/sushi.jpg", title: "Lunch Sushi üç£", text: "‚ÄúLet me feed you sushi for once üòâ this one's on me okay?‚Äù" },
            photobox: { image: "images/photobox.jpg", title: "Photobox üì∏", text: "‚ÄúNo overthinking ‚Äî just smile! I already know which pose I want üòâüì∏‚Äù" },
            coffee: { image: "images/coffee.jpg", title: "Ngopi & Yapping ‚òï", text: "‚ÄúOur favorite topic: literally everything and nothing ‚òïüí≠‚Äù" },
            gift: { image: "images/gift.jpg", title: "Gift Reveal üéÅ‚ú®", text: "‚ÄúIt's still a surprise... but I hope it makes your heart full ü´∂üíå‚Äù" }
        };

        document.querySelectorAll('.cardItem').forEach(item => {
            item.addEventListener('click', () => {
                const activityId = item.dataset.activity;
                const data = rundownData[activityId];
                if (data) {
                    createConfetti();
                    document.getElementById('popupImage').src = data.image;
                    document.getElementById('popupTitle').innerHTML = data.title;
                    document.getElementById('popupText').innerHTML = data.text;
                    rundownOverlay.classList.add('show');
                }
            });
        });
        document.getElementById('closeRundownPopup').addEventListener('click', () => rundownOverlay.classList.remove('show'));

        const noBtn = document.getElementById('noBtn');
        let escapeCount = 0;
        noBtn.addEventListener('mouseenter', () => {x
            if (escapeCount < 4) {
                const x = Math.random()*300-150, y = Math.random()*150-75;
                noBtn.style.transform = `translate(${x}px, ${y}px) rotate(${Math.random()*20-10}deg)`;
                escapeCount++;
            } else {
                createConfetti();
                noBtnOverlay.classList.add('show');
                noBtn.style.transform = ''; escapeCount = 0;
            }
        });
        noBtn.addEventListener('mousedown', () => {
          createConfetti();
          noBtnOverlay.classList.add('show');
        });
        document.getElementById('closePopup').addEventListener('click', () => noBtnOverlay.classList.remove('show'));

        document.getElementById('envelope').addEventListener('click', (e) => {
            createSparkles(e); 
            createConfetti();
            letterModal.classList.add('show');
            const big = document.createElement('div'); big.className='big-love'; big.textContent='üíñ';
            document.body.appendChild(big); setTimeout(()=>big.remove(),2500);
        });
        document.getElementById('closeLetter').addEventListener('click', () => letterModal.classList.remove('show'));

        const heartsContainer = document.getElementById('heartsContainer');
        const sparkleTrail = document.getElementById('sparkleTrail');

        createConfetti = function() {
          const colors=['#ff6b9d','#ffd700','#ff69b4','#87ceeb','#98fb98','#ffb3d9','#ffa07a'];
          const shapes=['üíï','üíñ','üå∏','ü¶ã','‚ú®','‚≠ê','üíù'];
          for(let i=0;i<60;i++){
            const c=document.createElement('div');
            c.className='confetti-piece';
            c.style.left=Math.random()*100+'%';
            if(Math.random()>.5){
              c.style.background=colors[Math.floor(Math.random()*colors.length)];
              c.style.borderRadius='50%';
            }else{
              c.textContent=shapes[Math.floor(Math.random()*shapes.length)];
              c.style.fontSize='16px';
              c.style.background='transparent';
            }
            c.style.animationDelay=Math.random()*0.6+'s';
            c.style.animationDuration=(Math.random()*2.5+2.5)+'s';
            document.body.appendChild(c);
            setTimeout(()=>c.remove(),4500);
          }
        }

        createSparkles = function(e){
            for(let i=0;i<8;i++){
                const s=document.createElement('div'); s.className='sparkle';
                s.style.left=e.clientX+'px'; s.style.top=e.clientY+'px';
                const angle=(Math.PI*2*i)/8, dist=40;
                s.style.setProperty('--tx',Math.cos(angle)*dist+'px');
                s.style.setProperty('--ty',Math.sin(angle)*dist+'px');
                document.body.appendChild(s); setTimeout(()=>s.remove(),1200);
            }
        };

        const createHeart = function(){
            const heart = document.createElement('div'); heart.className = 'heart';
            heart.textContent = ['üíï','üíñ','üíó','üíù'][Math.floor(Math.random()*4)];
            heart.style.left = Math.random()*100 + '%';
            heart.style.animationDelay = Math.random()*2 + 's';
            heart.style.animationDuration = (Math.random()*3 + 5) + 's';
            heartsContainer.appendChild(heart); setTimeout(()=>heart.remove(),8000);
        };
        setInterval(createHeart,600);

        let trailTimeout;
        document.addEventListener('mousemove', (e)=>{
            if(trailTimeout) return;
            trailTimeout = setTimeout(()=>{
                const trail = document.createElement('div'); trail.className = 'trail-item';
                trail.textContent = '‚ú®';
                trail.style.left = e.clientX + 'px'; trail.style.top = e.clientY + 'px';
                sparkleTrail.appendChild(trail);
                setTimeout(()=>trail.remove(),1000); trailTimeout = null;
            },50);
        });

        document.querySelectorAll('.fit').forEach(item => {
            item.addEventListener('click', (e) => {
              createSparkles(e);
              createConfetti();
            });
        });
    }
</script>
</body>
</html>